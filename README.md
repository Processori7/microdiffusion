# MicroDiffusion

Упрощенная реализация Stable Diffusion для генерации изображений по текстовому описанию. Проект разработан с учетом работы на слабом железе и включает в себя полную теоретическую базу с комментариями.

## Теоретическая база

Диффузионные модели работают по принципу двухэтапного процесса:

1. **Прямой процесс (диффузия)**:
   - Постепенно добавляем шум к изображению
   - Формула: q(x_t | x_{t-1}) = N(x_t; sqrt(α_t)x_{t-1}, (1-α_t)I)

2. **Обратный процесс**:
   - Обучаем нейросеть восстанавливать изображение из шума
   - Формула: p_θ(x_{t-1} | x_t) = N(x_{t-1}; μ_θ(x_t, t), σ^2I)

## Основные модули

1. **TinyUNet** (Архитектура модели):
   - Encoder: свёрточные блоки (3→16→32→64 каналов)
   - Middle: обработка признаков (64→128→64 каналов)
   - Decoder: развёрточные блоки с skip-connections

2. **TextEncoder**:
   - Преобразование текстовых запросов в числовые векторы
   - Использует TF-IDF векторизацию

3. **DiffusionProcess**:
   - Реализация прямого и обратного процессов диффузии
   - Настраиваемое количество шагов шума

4. **ArtDataset**:
   - Подготовка и загрузка датасета изображений
   - Поддержка различных форматов (.png, .jpg, .jpeg)

5. **DiffusionGUI**:
   - Графический интерфейс на CustomTkinter
   - Ввод текстового запроса
   - Генерация и отображение результатов

## Установка и запуск

### Клонирование репозитория

```bash
git clone https://github.com/Processori7/microdiffusion.git
cd microdiffusion
```

### Создание виртуального окружения

**Windows:**
```bash
python -m venv venv
.\venv\Scripts\activate
```

**Linux/MacOS:**
```bash
python3 -m venv venv
source venv/bin/activate
```

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск приложения

```bash
python main.py
```

При первом запуске:
1. Автоматически скачается датасет изображений
2. Начнется процесс обучения модели
3. После обучения откроется графический интерфейс

## Системные требования

- Python 3.8+
- CPU или GPU с поддержкой CUDA (опционально)
- Минимум 4GB RAM
- Около 2 GB свободного места на диске

## Зависимости

- torch: Основной фреймворк для нейросетей
- customtkinter: Современный GUI интерфейс
- numpy: Работа с массивами данных
- Pillow: Обработка изображений
- scikit-learn: TF-IDF векторизация
- matplotlib: Визуализация
- tqdm: Прогресс-бары
- duckduckgo-search: Поиск изображений для датасета

## Особенности реализации

- Использование mixed precision (FP16) для оптимизации памяти
- Автоматическая загрузка датасета через DuckDuckGo
- Современный тёмный интерфейс
- Оптимизированная архитектура для работы на CPU
